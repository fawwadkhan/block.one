{"ast":null,"code":"import _toConsumableArray from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/madcad/Documents/block.three/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{JsonRpc}from'eosjs';import endpoint from'../../endpoint/endpoint';import BlockInfo from'../commons/BlockInfo';import Spinner from'../commons/Spinner';import{setInterval}from'timers';var Landing=/*#__PURE__*/function(_Component){_inherits(Landing,_Component);function Landing(props){var _this;_classCallCheck(this,Landing);_this=_possibleConstructorReturn(this,_getPrototypeOf(Landing).call(this,props));_this.isComponentMounted=false;_this.state={maxLimit:10,currLimit:0,blockContainer:[],errors:'',block:{},rpcConnection:''};_this.getLatestBlocks=_this.getLatestBlocks.bind(_assertThisInitialized(_this));_this.getBlocks=_this.getBlocks.bind(_assertThisInitialized(_this));_this.loadLatestBlock=_this.loadLatestBlock.bind(_assertThisInitialized(_this));_this.intervalOBJ=null;return _this;}_createClass(Landing,[{key:\"loadLatestBlock\",value:function loadLatestBlock(){this.setState({currLimit:0,blockContainer:[],block:{}});this.getLatestBlocks();}},{key:\"getBlocks\",value:function getBlocks(){var _this2=this;if(this.state.currLimit===this.state.maxLimit){clearInterval(this.intervalOBJ._id);}else{var rpc=this.state.rpcConnection;rpc.get_info().then(function(data){if(data.head_block_num){if(!_this2.state.block[data.head_block_num]&&_this2.isComponentMounted){_this2.setState(function(){return{block:_objectSpread({},_this2.state.block,_defineProperty({},data.head_block_num,data.head_block_num))};});rpc.get_block(data.head_block_num).then(function(block_data){if(block_data&&_this2.isComponentMounted){_this2.setState({blockContainer:[].concat(_toConsumableArray(_this2.state.blockContainer),[block_data])});}if(_this2.isComponentMounted){_this2.setState({currLimit:_this2.state.currLimit+1});}}).catch(function(err){if(_this2.isComponentMounted){_this2.setState({errors:'Failed to fetch block, '+err});}});}}}).catch(function(err){if(_this2.isComponentMounted){_this2.setState({errors:'Failed to fetch info, '+err});}});}}},{key:\"getLatestBlocks\",value:function getLatestBlocks(){this.intervalOBJ=setInterval(this.getBlocks,800);}},{key:\"componentDidMount\",value:function componentDidMount(){this.isComponentMounted=true;this.setState({rpcConnection:new JsonRpc(endpoint)});this.getLatestBlocks();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.isComponentMounted=false;}},{key:\"render\",value:function render(){var blockContainer=this.state.blockContainer;var blockHeadContainer;var submitButtonContainer;if(blockContainer.length===10){blockHeadContainer=blockContainer.map(function(block){return React.createElement(BlockInfo,{key:block.block_num,information:block});});submitButtonContainer=React.createElement(\"div\",{style:{margin:'0 auto'}},React.createElement(\"input\",{type:\"submit\",value:\"Load latest blocks\",onClick:this.loadLatestBlock,className:\"btn btn-info btn-block mt-4\"}));}else{blockHeadContainer=React.createElement(Spinner,{count:this.state.currLimit});}return React.createElement(\"div\",{className:\"container\"},React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col-md-12\"},React.createElement(\"h3\",null,\"Latest Blocks\"),React.createElement(\"hr\",null)),React.createElement(\"div\",{className:\"col-sm-8\"},React.createElement(\"p\",{className:\"lead font-weight-bold\"},\"BlockID\")),React.createElement(\"div\",{className:\"col-sm-2\"},React.createElement(\"p\",{className:\"lead font-weight-bold\"},\"Timestamp\")),React.createElement(\"div\",{className:\"col-sm-2\"},React.createElement(\"p\",{className:\"lead font-weight-bold\"},\"Transactions\")),blockHeadContainer,submitButtonContainer));}}]);return Landing;}(Component);export default Landing;","map":{"version":3,"sources":["/Users/madcad/Documents/block.three/src/components/layout/Landing.js"],"names":["React","Component","JsonRpc","endpoint","BlockInfo","Spinner","setInterval","Landing","props","isComponentMounted","state","maxLimit","currLimit","blockContainer","errors","block","rpcConnection","getLatestBlocks","bind","getBlocks","loadLatestBlock","intervalOBJ","setState","clearInterval","_id","rpc","get_info","then","data","head_block_num","get_block","block_data","catch","err","blockHeadContainer","submitButtonContainer","length","map","block_num","margin"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { JsonRpc } from 'eosjs';\nimport endpoint from '../../endpoint/endpoint';\nimport BlockInfo from '../commons/BlockInfo';\nimport Spinner from '../commons/Spinner';\nimport { setInterval } from 'timers';\n\nclass Landing extends Component {\n\n  isComponentMounted = false;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      maxLimit: 10,\n      currLimit: 0,\n      blockContainer: [],\n      errors: '',\n      block: {},\n      rpcConnection: ''\n    }\n    this.getLatestBlocks = this.getLatestBlocks.bind(this);\n    this.getBlocks = this.getBlocks.bind(this);\n    this.loadLatestBlock = this.loadLatestBlock.bind(this);\n    this.intervalOBJ = null;\n  }\n\n  loadLatestBlock() {\n    this.setState({\n      currLimit: 0,\n      blockContainer: [],\n      block: {}\n    });\n\n    this.getLatestBlocks();\n  }\n\n  getBlocks() {\n    if (this.state.currLimit === this.state.maxLimit) {\n      clearInterval(this.intervalOBJ._id);\n    } else {\n      let rpc = this.state.rpcConnection;\n      rpc.get_info().then(data => {\n        if (data.head_block_num) {\n          if (!this.state.block[data.head_block_num] && this.isComponentMounted) {\n            this.setState(() => ({\n              block: {\n                ...this.state.block,\n                [data.head_block_num]: data.head_block_num,\n              }\n            }));\n            rpc.get_block(data.head_block_num).then(block_data => {\n              if (block_data && this.isComponentMounted) {\n                this.setState({ blockContainer: [...this.state.blockContainer, block_data] })\n              }\n              if(this.isComponentMounted){\n                this.setState({\n                  currLimit: this.state.currLimit + 1\n                })\n              }\n              \n            }).catch(err => {\n              if(this.isComponentMounted){\n                this.setState({ errors: 'Failed to fetch block, ' + err })\n              }\n              \n            })\n          }\n        }\n      }).catch(err => {\n        if(this.isComponentMounted){\n          this.setState({ errors: 'Failed to fetch info, ' + err })\n        }\n        \n      });\n    }\n\n  }\n\n  getLatestBlocks() {\n    this.intervalOBJ = setInterval(this.getBlocks, 800)\n  }\n\n  componentDidMount() {\n    this.isComponentMounted = true;\n    this.setState({ rpcConnection: new JsonRpc(endpoint) });\n    this.getLatestBlocks();\n  }\n\n  componentWillUnmount() {\n    this.isComponentMounted = false;\n  }\n\n  render() {\n\n    const { blockContainer } = this.state;\n\n    let blockHeadContainer;\n\n    let submitButtonContainer;\n\n    if (blockContainer.length === 10) {\n      blockHeadContainer = blockContainer.map(block => (\n        <BlockInfo key={block.block_num} information={block} />\n      ))\n      submitButtonContainer = (\n        <div style={{ margin: '0 auto' }}>\n          <input type=\"submit\" value=\"Load latest blocks\" onClick={this.loadLatestBlock} className=\"btn btn-info btn-block mt-4\" />\n        </div>\n      )\n    } else {\n      blockHeadContainer = <Spinner count={this.state.currLimit} />\n    }\n\n    return (\n      <div className=\"container\">\n        <div className=\"row\">\n          <div className=\"col-md-12\">\n            <h3>Latest Blocks</h3>\n            <hr />\n          </div>\n          <div className=\"col-sm-8\"><p className=\"lead font-weight-bold\">BlockID</p></div>\n          <div className=\"col-sm-2\"><p className=\"lead font-weight-bold\">Timestamp</p></div>\n          <div className=\"col-sm-2\"><p className=\"lead font-weight-bold\">Transactions</p></div>\n          {blockHeadContainer}\n          {submitButtonContainer}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Landing;\n"]},"metadata":{},"sourceType":"module"}